ã
RC:\Project\SchoolManagementSystem\BusinessService.Data\BusinessServiceDbContext.cs
	namespace 	
BusinessService
 
. 
Data 
{ 
public 

class $
BusinessServiceDbContext )
:+ ,
	DbContext, 5
{ 
public 
DbSet 
< 
Student 
> 
Students &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public		 
DbSet		 
<		 
Course		 
>		 
Courses		 $
{		% &
get		' *
;		* +
set		, /
;		/ 0
}		1 2
public

 
DbSet

 
<

 
School

 
>

 
Schools

 $
{

% &
get

' *
;

* +
set

, /
;

/ 0
}

1 2
public 
DbSet 
< 
Class 
> 
classes #
{$ %
get& )
;) *
set+ .
;. /
}0 1
	protected 
override 
void 
OnConfiguring  -
(- .#
DbContextOptionsBuilder. E
optionsBuilderF T
)T U
{ 	
optionsBuilder 
. 
UseSqlServer '
(' (
$str	( ¬
)
¬ ­
;
­ ®
} 	
} 
} “Z
\C:\Project\SchoolManagementSystem\BusinessService.Data\Migrations\20200509073342_createBD.cs
	namespace 	
BusinessService
 
. 
Data 
. 

Migrations )
{ 
public 

partial 
class 
createBD !
:" #
	Migration$ -
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
CreateTable		 (
(		( )
name

 
:

 
$str

 
,

  
columns 
: 
table 
=> !
new" %
{ 
ClassId 
= 
table #
.# $
Column$ *
<* +
int+ .
>. /
(/ 0
nullable0 8
:8 9
false: ?
)? @
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
	ClassName 
= 
table  %
.% &
Column& ,
<, -
string- 3
>3 4
(4 5
nullable5 =
:= >
false? D
)D E
,E F
Description 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
nullable7 ?
:? @
trueA E
)E F
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 1
,1 2
x3 4
=>5 7
x8 9
.9 :
ClassId: A
)A B
;B C
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
,  
columns 
: 
table 
=> !
new" %
{ 
CourseId 
= 
table $
.$ %
Column% +
<+ ,
int, /
>/ 0
(0 1
nullable1 9
:9 :
false; @
)@ A
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B

CourseName 
=  
table! &
.& '
Column' -
<- .
string. 4
>4 5
(5 6
nullable6 >
:> ?
false@ E
)E F
,F G
Description 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
nullable7 ?
:? @
trueA E
)E F
} 
, 
constraints   
:   
table   "
=>  # %
{!! 
table"" 
."" 

PrimaryKey"" $
(""$ %
$str""% 1
,""1 2
x""3 4
=>""5 7
x""8 9
.""9 :
CourseId"": B
)""B C
;""C D
}## 
)## 
;## 
migrationBuilder%% 
.%% 
CreateTable%% (
(%%( )
name&& 
:&& 
$str&& 
,&&  
columns'' 
:'' 
table'' 
=>'' !
new''" %
{(( 
Id)) 
=)) 
table)) 
.)) 
Column)) %
<))% &
int))& )
>))) *
())* +
nullable))+ 3
:))3 4
false))5 :
))): ;
.** 

Annotation** #
(**# $
$str**$ 8
,**8 9
$str**: @
)**@ A
,**A B

SchoolName++ 
=++  
table++! &
.++& '
Column++' -
<++- .
string++. 4
>++4 5
(++5 6
nullable++6 >
:++> ?
false++@ E
)++E F
,++F G

SchoolType,, 
=,,  
table,,! &
.,,& '
Column,,' -
<,,- .
string,,. 4
>,,4 5
(,,5 6
nullable,,6 >
:,,> ?
false,,@ E
),,E F
,,,F G
City-- 
=-- 
table--  
.--  !
Column--! '
<--' (
string--( .
>--. /
(--/ 0
nullable--0 8
:--8 9
false--: ?
)--? @
,--@ A
Country.. 
=.. 
table.. #
...# $
Column..$ *
<..* +
string..+ 1
>..1 2
(..2 3
nullable..3 ;
:..; <
false..= B
)..B C
}// 
,// 
constraints00 
:00 
table00 "
=>00# %
{11 
table22 
.22 

PrimaryKey22 $
(22$ %
$str22% 1
,221 2
x223 4
=>225 7
x228 9
.229 :
Id22: <
)22< =
;22= >
}33 
)33 
;33 
migrationBuilder55 
.55 
CreateTable55 (
(55( )
name66 
:66 
$str66  
,66  !
columns77 
:77 
table77 
=>77 !
new77" %
{88 
Id99 
=99 
table99 
.99 
Column99 %
<99% &
int99& )
>99) *
(99* +
nullable99+ 3
:993 4
false995 :
)99: ;
.:: 

Annotation:: #
(::# $
$str::$ 8
,::8 9
$str::: @
)::@ A
,::A B
Name;; 
=;; 
table;;  
.;;  !
Column;;! '
<;;' (
string;;( .
>;;. /
(;;/ 0
nullable;;0 8
:;;8 9
false;;: ?
);;? @
,;;@ A
DOB<< 
=<< 
table<< 
.<<  
Column<<  &
<<<& '
string<<' -
><<- .
(<<. /
nullable<</ 7
:<<7 8
false<<9 >
)<<> ?
,<<? @
Gender== 
=== 
table== "
.==" #
Column==# )
<==) *
string==* 0
>==0 1
(==1 2
nullable==2 :
:==: ;
false==< A
)==A B
,==B C
City>> 
=>> 
table>>  
.>>  !
Column>>! '
<>>' (
string>>( .
>>>. /
(>>/ 0
nullable>>0 8
:>>8 9
true>>: >
)>>> ?
,>>? @
CourseId?? 
=?? 
table?? $
.??$ %
Column??% +
<??+ ,
int??, /
>??/ 0
(??0 1
nullable??1 9
:??9 :
false??; @
)??@ A
,??A B
SchoolId@@ 
=@@ 
table@@ $
.@@$ %
Column@@% +
<@@+ ,
int@@, /
>@@/ 0
(@@0 1
nullable@@1 9
:@@9 :
false@@; @
)@@@ A
,@@A B
ClassIdAA 
=AA 
tableAA #
.AA# $
ColumnAA$ *
<AA* +
intAA+ .
>AA. /
(AA/ 0
nullableAA0 8
:AA8 9
falseAA: ?
)AA? @
}BB 
,BB 
constraintsCC 
:CC 
tableCC "
=>CC# %
{DD 
tableEE 
.EE 

PrimaryKeyEE $
(EE$ %
$strEE% 2
,EE2 3
xEE4 5
=>EE6 8
xEE9 :
.EE: ;
IdEE; =
)EE= >
;EE> ?
tableFF 
.FF 

ForeignKeyFF $
(FF$ %
nameGG 
:GG 
$strGG ;
,GG; <
columnHH 
:HH 
xHH  !
=>HH" $
xHH% &
.HH& '
ClassIdHH' .
,HH. /
principalTableII &
:II& '
$strII( 1
,II1 2
principalColumnJJ '
:JJ' (
$strJJ) 2
,JJ2 3
onDeleteKK  
:KK  !
ReferentialActionKK" 3
.KK3 4
CascadeKK4 ;
)KK; <
;KK< =
tableLL 
.LL 

ForeignKeyLL $
(LL$ %
nameMM 
:MM 
$strMM <
,MM< =
columnNN 
:NN 
xNN  !
=>NN" $
xNN% &
.NN& '
CourseIdNN' /
,NN/ 0
principalTableOO &
:OO& '
$strOO( 1
,OO1 2
principalColumnPP '
:PP' (
$strPP) 3
,PP3 4
onDeleteQQ  
:QQ  !
ReferentialActionQQ" 3
.QQ3 4
CascadeQQ4 ;
)QQ; <
;QQ< =
tableRR 
.RR 

ForeignKeyRR $
(RR$ %
nameSS 
:SS 
$strSS <
,SS< =
columnTT 
:TT 
xTT  !
=>TT" $
xTT% &
.TT& '
SchoolIdTT' /
,TT/ 0
principalTableUU &
:UU& '
$strUU( 1
,UU1 2
principalColumnVV '
:VV' (
$strVV) -
,VV- .
onDeleteWW  
:WW  !
ReferentialActionWW" 3
.WW3 4
CascadeWW4 ;
)WW; <
;WW< =
}XX 
)XX 
;XX 
migrationBuilderZZ 
.ZZ 
CreateIndexZZ (
(ZZ( )
name[[ 
:[[ 
$str[[ +
,[[+ ,
table\\ 
:\\ 
$str\\ !
,\\! "
column]] 
:]] 
$str]] !
)]]! "
;]]" #
migrationBuilder__ 
.__ 
CreateIndex__ (
(__( )
name`` 
:`` 
$str`` ,
,``, -
tableaa 
:aa 
$straa !
,aa! "
columnbb 
:bb 
$strbb "
)bb" #
;bb# $
migrationBuilderdd 
.dd 
CreateIndexdd (
(dd( )
nameee 
:ee 
$stree ,
,ee, -
tableff 
:ff 
$strff !
,ff! "
columngg 
:gg 
$strgg "
)gg" #
;gg# $
}hh 	
	protectedjj 
overridejj 
voidjj 
Downjj  $
(jj$ %
MigrationBuilderjj% 5
migrationBuilderjj6 F
)jjF G
{kk 	
migrationBuilderll 
.ll 
	DropTablell &
(ll& '
namemm 
:mm 
$strmm  
)mm  !
;mm! "
migrationBuilderoo 
.oo 
	DropTableoo &
(oo& '
namepp 
:pp 
$strpp 
)pp  
;pp  !
migrationBuilderrr 
.rr 
	DropTablerr &
(rr& '
namess 
:ss 
$strss 
)ss  
;ss  !
migrationBuilderuu 
.uu 
	DropTableuu &
(uu& '
namevv 
:vv 
$strvv 
)vv  
;vv  !
}ww 	
}xx 
}yy Ð
AC:\Project\SchoolManagementSystem\BusinessService.Data\Program.cs
	namespace 	
BusinessService
 
. 
Data 
{ 
public 

static 
class 
Program 
{ 
static 
void 
Main 
( 
string 
[  
]  !
args" &
)& '
{ 	
Console		 
.		 
	WriteLine		 
(		 
$str		 ,
)		, -
;		- .
}

 	
} 
} È
VC:\Project\SchoolManagementSystem\BusinessService.Data\Repositories\ClassRepository.cs
	namespace 	
BusinessService
 
. 
Data 
. 
Repositories +
{ 
public 

class 
ClassRepository  
:  !

Repository! +
<+ ,
Class, 1
>1 2
{ 
private 
readonly $
BusinessServiceDbContext 1
context2 9
=: ;
new< ?$
BusinessServiceDbContext@ X
(X Y
)Y Z
;Z [
public		 
void		 
update		 
(		 
int		 
id		 !
,		! "
Class		# (
entities		) 1
)		1 2
{

 	
var 
classdetail 
=  !
context" )
.) *
classes* 1
.1 2
FirstOrDefault2 @
(@ A
eA B
=>C E
eF G
.G H
ClassIdH O
==P R
idS U
)U V
;V W
if 
( 
classdetail 
!=  "
null# '
)' (
{ 
classdetail 
.  
ClassId  '
=( )
entities* 2
.2 3
ClassId3 :
;: ;
classdetail 
.  
	ClassName  )
=* +
entities, 4
.4 5
	ClassName5 >
;> ?
classdetail 
.  
Description  +
=, -
entities. 6
.6 7
Description7 B
;B C
context 
. 
SaveChanges '
(' (
)( )
;) *
} 
} 	
} 
} Ö
WC:\Project\SchoolManagementSystem\BusinessService.Data\Repositories\CourseRepository.cs
	namespace 	
BusinessService
 
. 
Data 
. 
Repositories +
{ 
public 

class 
CourseRepository !
:! "

Repository" ,
<, -
Course- 3
>3 4
{ 
private 
readonly $
BusinessServiceDbContext 1
context2 9
=: ;
new< ?$
BusinessServiceDbContext@ X
(X Y
)Y Z
;Z [
public		 
void		 
update		 
(		 
int		 
id		 !
,		! "
Course		# )
entities		* 2
)		2 3
{

 	
var 
coursedetail  
=! "
context# *
.* +
Courses+ 2
.2 3
FirstOrDefault3 A
(A B
eB C
=>D F
eG H
.H I
CourseIdI Q
==R T
idU W
)W X
;X Y
if 
( 
coursedetail  
!=! #
null$ (
)( )
{ 
coursedetail  
.  !
CourseId! )
=* +
entities, 4
.4 5
CourseId5 =
;= >
coursedetail  
.  !

CourseName! +
=, -
entities. 6
.6 7

CourseName7 A
;A B
coursedetail  
.  !
Description! ,
=- .
entities/ 7
.7 8
Description8 C
;C D
context 
. 
SaveChanges '
(' (
)( )
;) *
} 
} 	
} 
} …
QC:\Project\SchoolManagementSystem\BusinessService.Data\Repositories\Repository.cs
	namespace 	
BusinessService
 
. 
Data 
. 
Repositories +
{ 
public 

class 

Repository 
< 
TEntity #
># $
where% *
TEntity+ 2
:2 3
class3 8
{		 
private

 
readonly

 $
BusinessServiceDbContext

 1
context

2 9
=

: ;
new

< ?$
BusinessServiceDbContext

@ X
(

X Y
)

Y Z
;

Z [
public 
TEntity 
Get 
( 
int 
id !
)! "
{ 	
try 
{ 
return 
context 
. 
Set "
<" #
TEntity# *
>* +
(+ ,
), -
.- .
Find. 2
(2 3
id3 5
)5 6
;6 7
} 
catch 
( 
	Exception 
) 
{ 
return 
null 
; 
} 
} 	
public 
IEnumerable 
< 
TEntity "
>" #
GetAll$ *
(* +
)+ ,
{ 	
return 
context 
. 
Set "
<" #
TEntity# *
>* +
(+ ,
), -
.- .
ToList. 4
(4 5
)5 6
;6 7
} 	
public 
void 
Add 
( 
TEntity 
entities  (
)( )
{ 	
context 
. 
Set 
< 
TEntity #
># $
($ %
)% &
.& '
Add' *
(* +
entities+ 3
)3 4
;4 5
context 
. 
SaveChanges #
(# $
)$ %
;% &
}   	
public!! 
void!! 
Delete!! 
(!! 
int!! 
id!! !
)!!! "
{"" 	
var## 
result## 
=## 
context## $
.##$ %
Set##% (
<##( )
TEntity##) 0
>##0 1
(##1 2
)##2 3
.##3 4
Find##4 8
(##8 9
id##9 ;
)##; <
;##< =
if$$ 
($$ 
result$$ 
!=$$ 
null$$ "
)$$" #
{%% 
context&& 
.&& 
Set&& 
<&&  
TEntity&&  '
>&&' (
(&&( )
)&&) *
.&&* +
Remove&&+ 1
(&&1 2
result&&2 8
)&&8 9
;&&9 :
context'' 
.'' 
SaveChanges'' '
(''' (
)''( )
;'') *
})) 
}** 	
},, 
}-- è
WC:\Project\SchoolManagementSystem\BusinessService.Data\Repositories\SchoolRepository.cs
	namespace 	
BusinessService
 
. 
Data 
. 
Repositories +
{ 
public 

class 
SchoolRepository !
:! "

Repository" ,
<, -
School- 3
>3 4
{ 
private 
readonly $
BusinessServiceDbContext 1
context2 9
=: ;
new< ?$
BusinessServiceDbContext@ X
(X Y
)Y Z
;Z [
public		 
void		 
update		 
(		 
int		 
id		 !
,		! "
School		# )
entities		* 2
)		2 3
{

 	
var 
schooldetail  
=! "
context# *
.* +
Schools+ 2
.2 3
FirstOrDefault3 A
(A B
eB C
=>D F
eG H
.H I
IdI K
==L N
idO Q
)Q R
;R S
if 
( 
schooldetail  
!=! #
null$ (
)( )
{ 
schooldetail  
.  !
Id! #
=$ %
entities& .
.. /
Id/ 1
;1 2
schooldetail  
.  !

SchoolName! +
=, -
entities. 6
.6 7

SchoolName7 A
;A B
schooldetail  
.  !

SchoolType! +
=, -
entities. 6
.6 7

SchoolType7 A
;A B
schooldetail  
.  !
City! %
=& '
entities( 0
.0 1
City1 5
;5 6
schooldetail  
.  !
Country! (
=) *
entities+ 3
.3 4
Country4 ;
;; <
context 
. 
SaveChanges '
(' (
)( )
;) *
} 
} 	
} 
} ö*
XC:\Project\SchoolManagementSystem\BusinessService.Data\Repositories\StudentRepository.cs
	namespace 	
BusinessService
 
. 
Data 
. 
Repositories +
{ 
public 

class 
StudentRepository "
:" #

Repository# -
<- .
Student. 5
>5 6
{		 
private

 
readonly

 $
BusinessServiceDbContext

 1
context

2 9
=

9 :
new

; >$
BusinessServiceDbContext

? W
(

W X
)

X Y
;

Y Z
public 
Student )
GetStudentWithAcademicDetails 4
(4 5
int5 8
id9 ;
); <
{ 	
var 
studentdetails "
=# $
context% ,
., -
Students- 5
.5 6
Where6 ;
(; <
e< =
=>> @
eA B
.B C
IdC E
==F H
idI K
)K L
. 
Include "
(" #
c# $
=>% '
c( )
.) *
classes* 1
)1 2
. 
Include "
(" #
p# $
=>% '
p( )
.) *
course* 0
)0 1
. 
Include "
(" #
s# $
=>% '
s( )
.) *
school* 0
)0 1
. 
First  
(  !
)! "
;" #
return 
studentdetails %
;% &
} 	
public 
IEnumerable 
< 
Student "
>" #!
GetAllStudentsDetails$ 9
(9 :
): ;
{ 	
var 
studentDetail 
= 
context  '
.' (
Students( 0
. 
Include "
(" #
c# $
=>% '
c( )
.) *
classes* 1
)1 2
. 
Include "
(" #
p# $
=>% '
p( )
.) *
course* 0
)0 1
. 
Include "
(" #
s# $
=>% '
s( )
.) *
school* 0
)0 1
. 
ToList !
(! "
)" #
;# $
return 
studentDetail $
;$ %
} 	
public 
IEnumerable 
< 
Student "
>" #!
GetStudentsBySchoolId$ 9
(9 :
int: =
id> @
)@ A
{ 	
var   
studentDetail   !
=  " #
context  $ +
.  + ,
Students  , 4
.  4 5
Where  5 :
(  : ;
e  ; <
=>  = ?
e  @ A
.  A B
SchoolId  B J
==  K M
id  N P
)  P Q
.!!$ %
Include!!% ,
(!!, -
c!!- .
=>!!/ 1
c!!2 3
.!!3 4
classes!!4 ;
)!!; <
.""$ %
Include""% ,
("", -
p""- .
=>""/ 1
p""2 3
.""3 4
course""4 :
)"": ;
.##$ %
ToList##% +
(##+ ,
)##, -
;##- .
return$$ 
studentDetail$$ $
;$$$ %
}%% 	
public&& 
void&& 
update&& 
(&& 
int&& 
id&& !
,&&! "
Student&&" )
entities&&* 2
)&&2 3
{'' 	
var(( 
studentdetail(( !
=((" #
context(($ +
.((+ ,
Students((, 4
.((4 5
FirstOrDefault((5 C
(((C D
e((D E
=>((F H
e((I J
.((J K
Id((K M
==((N P
id((Q S
)((S T
;((T U
if)) 
()) 
studentdetail)) !
!=))" $
null))% )
)))) *
{** 
studentdetail++ !
.++! "
Id++" $
=++% &
entities++' /
.++/ 0
Id++0 2
;++2 3
studentdetail,, !
.,,! "
Name,," &
=,,' (
entities,,) 1
.,,1 2
Name,,2 6
;,,6 7
studentdetail-- !
.--! "
DOB--" %
=--& '
entities--( 0
.--0 1
DOB--1 4
;--4 5
studentdetail.. !
...! "
Gender.." (
=..) *
entities..+ 3
...3 4
Gender..4 :
;..: ;
studentdetail// !
.//! "
City//" &
=//' (
entities//) 1
.//1 2
City//2 6
;//6 7
studentdetail00 !
.00! "
ClassId00" )
=00* +
entities00, 4
.004 5
ClassId005 <
;00< =
studentdetail11 !
.11! "
CourseId11" *
=11+ ,
entities11- 5
.115 6
CourseId116 >
;11> ?
studentdetail22 !
.22! "
SchoolId22" *
=22+ ,
entities22- 5
.225 6
SchoolId226 >
;22> ?
context33 
.33 
SaveChanges33 '
(33' (
)33( )
;33) *
}44 
}55 	
}66 
}77 